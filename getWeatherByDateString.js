// const dates = ["2022-11-22T07:38", "2022-11-22T15:09", "2022-11-22T21:37", "2022-11-23T08:30", "2022-11-23T17:04", "2022-11-24T08:52", "2022-11-25T15:00", "2022-11-27T08:25", "2022-11-28T08:02", "2022-11-29T07:33", "2022-11-30T06:13", "2022-12-01T07:21", "2022-12-02T06:01", "2022-12-03T06:05", "2022-12-04T09:30", "2022-12-05T07:18", "2022-12-06T07:19", "2022-12-07T07:23", "2022-12-08T07:24", "2022-12-09T07:27", "2022-12-10T07:02", "2022-12-11T07:45", "2022-12-12T07:17", "2022-12-13T06:42", "2022-12-14T05:47", "2022-12-15T06:00", "2022-12-16T07:10", "2022-12-18T18:30", "2022-12-19T07:09", "2022-12-20T08:48", "2022-12-21T06:01", "2022-12-22T07:16", "2022-12-23T07:14", "2022-12-24T19:56", "2022-12-25T09:29", "2022-12-25T19:11", "2022-12-25T20:50", "2022-12-26T05:17", "2022-12-27T06:44", "2022-12-27T15:57", "2022-12-27T18:54", "2022-12-28T06:22", "2022-12-28T08:26", "2022-12-28T11:32", "2022-12-28T15:34", "2022-12-29T07:12", "2022-12-29T11:50", "2022-12-29T21:41", "2022-12-30T03:20", "2022-12-30T07:26", "2022-12-30T17:16", "2022-12-30T21:35", "2022-12-31T06:48", "2022-12-31T12:08", "2022-12-31T19:43", "2023-01-01T00:23", "2023-01-01T07:38", "2023-01-01T10:59", "2023-01-01T20:20", "2023-01-01T22:12", "2023-01-02T07:19", "2023-01-02T12:49", "2023-01-02T16:59", "2023-01-02T21:43", "2023-01-03T07:10", "2023-01-03T17:05", "2023-01-03T22:23", "2023-01-04T06:08", "2023-01-04T22:24", "2023-01-05T07:11", "2023-01-05T22:03", "2023-01-06T05:58", "2023-01-06T16:29", "2023-01-06T19:55", "2023-01-07T06:27", "2023-01-07T14:20", "2023-01-07T19:12"]

//test dates
const dates = ["2022-11-22T07:38", "2022-11-22T15:09", "2022-11-22T21:37"]

const results = [];

async function getWeatherByDateString(dateISOString) {
    // let dateISOString = "2022-11-15T11:59"
    dateISOString = dateISOString.slice(0, 14) + "00"
    let dateQueryString = dateISOString.slice(0, 10)
    // console.log("query", dateISOString, dateQueryString)

    const response = await fetch("https://archive-api.open-meteo.com/v1/archive?latitude=38.84&longitude=-77.43&start_date=" + dateQueryString + "&end_date=" + dateQueryString + "&hourly=temperature_2m&timezone=America%2FNew_York&temperature_unit=fahrenheit")
    const data = await response.json();

    let timeIndex = data.hourly.time.indexOf(dateISOString)
    let tempAtTimeIndex = data.hourly.temperature_2m[timeIndex]
    console.log(tempAtTimeIndex)
    log.push({ dateISO: dateISOString, temp: tempAtTimeIndex })
}

for (let i = 0; i < dates.length; i++) {
    getWeatherByDateString(dates[i])
}

console.log(results)

// response from weather api
// {
//     "latitude": 38.800003,
//     "longitude": -77.4,
//     "generationtime_ms": 0.27000904083251953,
//     "utc_offset_seconds": -18000,
//     "timezone": "America/New_York",
//     "timezone_abbreviation": "EST",
//     "elevation": 106,
//     "hourly_units": {
//         "time": "iso8601",
//         "temperature_2m": "Â°F"
//     },
//     "hourly": {
//         "time": [
//             "2022-11-15T00:00",
//             "2022-11-15T01:00",
//             "2022-11-15T02:00",
//             "2022-11-15T03:00",
//             "2022-11-15T04:00",
//             "2022-11-15T05:00",
//             "2022-11-15T06:00",
//             "2022-11-15T07:00",
//             "2022-11-15T08:00",
//             "2022-11-15T09:00",
//             "2022-11-15T10:00",
//             "2022-11-15T11:00",
//             "2022-11-15T12:00",
//             "2022-11-15T13:00",
//             "2022-11-15T14:00",
//             "2022-11-15T15:00",
//             "2022-11-15T16:00",
//             "2022-11-15T17:00",
//             "2022-11-15T18:00",
//             "2022-11-15T19:00",
//             "2022-11-15T20:00",
//             "2022-11-15T21:00",
//             "2022-11-15T22:00",
//             "2022-11-15T23:00"
//         ],
//         "temperature_2m": [
//             39,
//             38.5,
//             36.1,
//             35.9,
//             36.1,
//             35.9,
//             36.4,
//             36.6,
//             38.1,
//             40.7,
//             42.5,
//             43.7,
//             43.7,
//             43.6,
//             40.9,
//             40,
//             40,
//             39.8,
//             39.7,
//             39.6,
//             39.1,
//             38.2,
//             37.9,
//             38.3
//         ]
//     }
// }